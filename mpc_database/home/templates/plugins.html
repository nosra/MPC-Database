{% extends 'base.html' %}
{% load static %}
{% block title %}Plugins{% endblock %}

{% block content %}
<!-- getting rid of borders for now -->
<div class="window flex min-h-dvh w-full border-[#004F99] overflow-hidden">
    <div class="plugin overflow-auto">
        <div class="plugin__categories flex flex-col text-left w-full h-full border-[#004F99] pl-10 pr-10 pt-5 gap-3">
            <label class="category__title font-bold text-center">
                Categories
            </label>

            <!-- pro/alt pills  -->
            <div class="flex gap-2 justify-center">
                <a href="{% url 'plugins' %}?tab=pro{% if active_category %}&category={{ active_category }}{% endif %}"
                class="px-3 py-1 rounded-full text-sm font-semibold transition-colors duration-200
                        {% if active_tab == 'pro' %}
                            bg-[#004F99] text-white
                        {% else %}
                            bg-[#1A356B] text-white hover:bg-[#005FCC]
                        {% endif %}">
                    PRO
                </a>

                <a href="{% url 'plugins' %}?tab=alt{% if active_category %}&category={{ active_category }}{% endif %}"
                class="px-3 py-1 rounded-full text-sm font-semibold transition-colors duration-200
                        {% if active_tab == 'alt' %}
                            bg-[#004F99] text-white
                        {% else %}
                            bg-[#1A356B] text-white hover:bg-[#005FCC]
                        {% endif %}">
                    ALT
                </a>
            </div>

            <!-- category pills -->
            <a href="{% url 'plugins' %}?tab={{ active_tab }}&category=EFX"
            class="category__pill flex flex-row gap-2 items-center rounded-4xl p-2 transition-colors duration-200 cursor-pointer
                    {% if active_category == 'EFX' %} bg-[#004F99] text-white {% else %} hover:bg-[#004F99] {% endif %}">
                <img class="size-7" src="{% static 'plugins/effects.svg' %}"/>
                <span class="category">
                    Effects
                </span>
            </a>

            <a href="{% url 'plugins' %}?tab={{ active_tab }}&category=SYN"
            class="category__pill flex flex-row gap-2 items-center rounded-4xl p-2 transition-colors duration-200 cursor-pointer
                    {% if active_category == 'SYN' %} bg-[#004F99] text-white {% else %} hover:bg-[#004F99] {% endif %}">
                <img class="size-7" src="{% static 'plugins/synth.svg' %}"/>
                <span class="category">
                    Synths
                </span>
            </a>

            <a href="{% url 'plugins' %}?tab={{ active_tab }}&category=CMP"
            class="category__pill flex flex-row gap-2 items-center rounded-4xl p-2 transition-colors duration-200 cursor-pointer
                    {% if active_category == 'CMP' %} bg-[#004F99] text-white {% else %} hover:bg-[#004F99] {% endif %}">
                <img class="size-7" src="{% static 'plugins/compress.svg' %}"/>
                <span class="category">
                    Compressors
                </span>
            </a>

            <a href="{% url 'plugins' %}?tab={{ active_tab }}&category=DST"
            class="category__pill flex flex-row gap-2 items-center rounded-4xl p-2 transition-colors duration-200 cursor-pointer
                    {% if active_category == 'DST' %} bg-[#004F99] text-white {% else %} hover:bg-[#004F99] {% endif %}">
                <img class="size-7" src="{% static 'plugins/distort.svg' %}"/>
                <span class="category">
                    Distorters
                </span>
            </a>

            <a href="{% url 'plugins' %}?tab={{ active_tab }}&category=DAW"
            class="category__pill flex flex-row gap-2 items-center rounded-4xl p-2 transition-colors duration-200 cursor-pointer
                    {% if active_category == 'DAW' %} bg-[#004F99] text-white {% else %} hover:bg-[#004F99] {% endif %}">
                <img class="size-7" src="{% static 'plugins/mixer.svg' %}"/>
                <span class="category">
                    DAW
                </span>
            </a>
        </div>
    </div>
    <div class="plugin__view grow bg-white rounded-3xl mr-12">
        <!-- search bar -->
        <div class="plugin__navbar flex flex-col items-center justify-center pt-4 pb-4 px-10">
            <!-- slick search input -->
            <div class="w-full max-w-md relative">
                <input
                    type="text"
                    placeholder="Search plugins..."
                    class="w-full rounded-2xl bg-gray-100 pl-12 pr-4 py-2
                        text-gray-800 placeholder-gray-400
                        shadow-sm border border-gray-200
                        focus:outline-none focus:ring-2 focus:ring-[#004F99] focus:border-transparent
                        transition duration-200"
                />

                <!-- icon -->
                <svg class="absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"
                    fill="none" stroke="currentColor" stroke-width="2"
                    viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1010.5 18a7.5 7.5 0 006.15-3.35z"/>
                </svg>
            </div>
        </div>
        

        <!-- this will be where the plugins are -->
        <div class="plugin__plugins flex flex-wrap">
            {% for plugin in plugins %}
                {% if active_tab == 'pro' %}
                    <a href="{% url 'plugin_detail' plugin.pk %}" class="block cursor-pointer">
                {% else %}
                    <a href="{% url 'alt_plugin_detail' plugin.pk %}" class="block cursor-pointer">
                {% endif %}
                    <div class="plugin_element flex flex-col p-5 cursor-pointer">
                        <div class="relative w-64 aspect-square overflow-hidden rounded-xl drop-shadow-xl/50">

                            {% if plugin.image %}
                                <img
                                    src="{{ plugin.image.url }}"
                                    class="absolute inset-0 w-full h-full object-cover"
                                    alt="{{ plugin.name }}"
                                />
                            {% else %}
                                <img
                                    src="{% static 'plugins/default-plugin.png' %}"
                                    class="absolute inset-0 w-full h-full object-cover"
                                    alt="{{ plugin.name }}"
                                />
                            {% endif %}

                            <!-- label -->
                            <div class="absolute top-3 left-3 w-20 p-1">
                                <div class="rounded-2xl flex justify-center
                                            {% if active_tab == 'pro' %} bg-[#004F99] {% else %} bg-[#1A356B] {% endif %}">
                                    <label class="font-bold">
                                        {% if active_tab == 'pro' %}PRO{% else %}ALT{% endif %}
                                    </label>
                                </div>
                            </div>

                            <!-- bottom blurred info panel -->
                            <div class="absolute bottom-0 w-full h-1/3 
                                        bg-black/40 backdrop-blur-sm 
                                        flex flex-col p-4 text-white">
                                <div class="flex flex-row justify-between">
                                    <label class="text-sm text-gray-200">
                                        {{ plugin.get_category_display }}
                                    </label>
                                    <label class="text-sm font-bold text-gray-50">
                                        ${{ plugin.price }}
                                    </label>
                                </div>

                                <label class="text-lg font-semibold mt-1">
                                    {{ plugin.name }}
                                </label>
                            </div>
                        </div>
                    </div>
                </a>
            {% empty %}
                <p class="text-gray-500 p-6">No plugins added yet.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}